<div>
    <div>
        <h3>Familienportal Kategorien</h3>
        <ul>
            <li ng-repeat="category in root.composite['famportal.category'] | orderBy:'composite[\'famportal.category.order\'].value'">
                {{category.value}}
                <ul>
                    <li ng-repeat="category in category.composite['famportal.category'] | orderBy:'composite[\'famportal.category.order\'].value'">
                        <a href="" ng-click="selectFamportalCategory(category)" ng-class="{selected: category.id == famportalCategory.id}">{{category.value}}</a>
                        <ul>
                            <li ng-repeat="category in category.composite['famportal.category'] | orderBy:'composite[\'famportal.category.order\'].value'">
                                <a href="" ng-click="selectFamportalCategory(category)" ng-class="{selected: category.id == famportalCategory.id}">{{category.value}}</a>
                                <ul>
                                    <li ng-repeat="category in category.composite['famportal.category'] | orderBy:'composite[\'famportal.category.order\'].value'">
                                        <a href="" ng-click="selectFamportalCategory(category)" ng-class="{selected: category.id == famportalCategory.id}">{{category.value}}</a>
                                        <ul>
                                            <li ng-repeat="category in category.composite['famportal.category'] | orderBy:'composite[\'famportal.category.order\'].value'">
                                                <a href="" ng-click="selectFamportalCategory(category)" ng-class="{selected: category.id == famportalCategory.id}">{{category.value}}</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</div>

<div>
    <div ng-if="famportalCategory">
        <h3>Zugeordnete Kiezatlas Objekte</h3>
        Kategorie <b>{{famportalCategory.value}}</b> <ng-pluralize count="geoObjects.length" when="{
            0: 'sind keine Kiezatlas Objekte zugeordnet.',
            'one': 'ist 1 Kiezatlas Objekt zugeordnet:',
            'other': 'sind {} Kiezatlas Objekte zugeordnet:'}"></ng-pluralize>
        <ul>
            <li ng-repeat="geoObject in geoObjects">
                <input type="checkbox" ng-model="geoObject.selected" ng-change="selectGeoObject()"> {{geoObject.value}}
            </li>
        </ul>
        <button ng-click="deleteAssignments()" ng-if="geoObjects" ng-disabled="!geoObjects.selectedCount">
            <ng-pluralize count="geoObjects.selectedCount" when="{
                '0': 'Zuordnung entfernen',
                'one': '1 Zuordnung entfernen',
                'other': '{} Zuordnungen entfernen'}"></ng-pluralize>
        </button>
    </div>
    <div ng-if="!famportalCategory">
        <br /><br /><br /><br />
        <div><-- WÃ¤hle eine Kategorie aus</div>
        <br />
    </div>
</div>

<div>
    <div>
        <h3>Kiezatlas Objekte suchen</h3>
        <input type="text" ng-model="searchTerm" ng-keyup="searchGeoObjects()">
        <ul>
            <li ng-repeat="criteriaResult in searchResult | orderBy:'criteria.value'">
                {{criteriaResult.criteria.value}}
                <ul>
                    <li ng-repeat="categoryResult in criteriaResult.categories | orderBy:'category.value'" ng-style="{'list-style-type': categoryResult.geo_objects.length ? 'none' : 'inherit'}">
                        <img class="expansion-handle" ng-if="categoryResult.geo_objects" ng-src="{{'/de.kiezatlas.famportal/images/' + (categoryResult.expanded ? 'expanded.png' : 'collapsed.png')}}" ng-click="categoryResult.expanded = !categoryResult.expanded">
                        {{categoryResult.category.value}}
                        <ul ng-show="categoryResult.expanded">
                            <li ng-repeat="geoObject in categoryResult.geo_objects | orderBy:'value'">
                                {{geoObject.value}}
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
        <p ng-if="searchResult.stats">
            {{searchResult.stats.geoObjectCount}} Kiezatlas Objekte (aus
            {{searchResult.stats.categoryCount}} Kategorien, aus
            {{searchResult.stats.criteriaCount}} Kriterien)
        </p>
        <button ng-click="createAssignments()" ng-if="searchResult" ng-disabled="!famportalCategory || !searchResult.stats.geoObjectCount">
            Zu Kategorie <b>{{famportalCategory.value}}</b> zuordnen
        </button>
    </div>
</div>
